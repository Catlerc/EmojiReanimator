{"version":3,"file":"Utils.js","sourceRoot":"","sources":["Utils.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,EAAC,MAAM,EAAC,MAAM,cAAc,CAAA;AAKnC;IAAA;IA+CA,CAAC;IA9CQ,sBAAgB,GAAvB,UAAwB,WAAwB,EAAE,IAAY;QAC5D,IAAM,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,WAAW,CAAC,EAAE,EAAC,IAAI,EAAE,QAAQ,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAC,CAAC,CAAA;QACxE,IAAM,UAAU,GAAG,MAAM,CAAC,GAAG,IAAI,MAAM,CAAC,SAAS,CAAA;QACjD,OAAO,UAAU,CAAC,eAAe,CAAC,IAAI,CAAC,CAAA;IACzC,CAAC;IAEM,kBAAY,GAAnB,UAAoB,KAAa,EAAE,MAAc;QAC/C,IAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;QACjD,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAA;QACtB,QAAQ,CAAC,MAAM,GAAG,MAAM,CAAA;QAGxB,OAAO,IAAI,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAA;IACpC,CAAC;IAEM,wBAAkB,GAAzB,UAA0B,SAAoB;QAC5C,IAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;QAC/C,IAAM,GAAG,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAA;QACnC,MAAM,CAAC,KAAK,GAAG,SAAS,CAAC,KAAK,CAAA;QAC9B,MAAM,CAAC,MAAM,GAAG,SAAS,CAAC,MAAM,CAAA;QAChC,GAAG,CAAC,YAAY,CAAC,SAAS,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;QAEjC,OAAO,MAAM,CAAC,SAAS,EAAE,CAAA;IAC3B,CAAC;IAEM,wBAAkB,GAAzB,UAA0B,SAAe;QACvC,IAAM,UAAU,GAAG,MAAM,CAAC,GAAG,IAAI,MAAM,CAAC,SAAS,CAAA;QACjD,OAAO,UAAU,CAAC,eAAe,CAAC,SAAS,CAAC,CAAA;IAC9C,CAAC;IAEM,4BAAsB,GAA7B,UAA8B,QAAgB;QAC5C,OAAO,IAAI,OAAO,CAAC,UAAA,OAAO,IAAI,OAAA,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAvC,CAAuC,CAAC,CAAA;IACxE,CAAC;IAEM,UAAI,GAAX,UAAkB,KAAU,EAAE,IAAO,EAAE,OAAgC;QACrE,IAAI,GAAG,GAAG,IAAI,CAAA;QACd,KAAgB,UAAK,EAAL,eAAK,EAAL,mBAAK,EAAL,IAAK;YAAhB,IAAM,CAAC,cAAA;YAAW,GAAG,GAAG,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC,CAAA;SAAA;QAC5C,OAAO,GAAG,CAAA;IACZ,CAAC;IAEY,eAAS,GAAtB,UAA6B,KAAU,EAAE,IAAO,EAAE,OAAyC;;;;;;wBACrF,GAAG,GAAG,IAAI,CAAA;8BACO,EAAL,eAAK;;;6BAAL,CAAA,mBAAK,CAAA;wBAAV,CAAC;wBAAiB,WAAM,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC,EAAA;;wBAA3B,GAAG,GAAG,SAAqB,CAAA;;;wBAAlC,IAAK,CAAA;;4BACrB,WAAO,GAAG,EAAA;;;;KACX;IAEH,YAAC;AAAD,CAAC,AA/CD,IA+CC","sourcesContent":["import {fabric} from \"../Vendor.js\"\r\nimport {DataUrl} from \"../Domain.js\"\r\nimport {FabricCanvas} from \"../FabricWrapper/FabricCanvas.js\"\r\nimport {FabricImage} from \"../FabricWrapper/FabricImage.js\"\r\n\r\nexport class Utils {\r\n  static arrayBufferToUrl(imageBuffer: ArrayBuffer, type: String): DataUrl {\r\n    const blob = new Blob([imageBuffer], {type: \"image/\" + type.toString()})\r\n    const urlCreator = window.URL || window.webkitURL\r\n    return urlCreator.createObjectURL(blob)\r\n  }\r\n\r\n  static createCanvas(width: number, height: number): FabricCanvas {\r\n    const renderer = document.createElement(\"canvas\")\r\n    renderer.width = width\r\n    renderer.height = height\r\n\r\n\r\n    return new fabric.Canvas(renderer)\r\n  }\r\n\r\n  static imageDataToDataUrl(imageData: ImageData): DataUrl {\r\n    const canvas = document.createElement(\"canvas\")\r\n    const ctx = canvas.getContext(\"2d\")\r\n    canvas.width = imageData.width\r\n    canvas.height = imageData.height\r\n    ctx.putImageData(imageData, 0, 0)\r\n\r\n    return canvas.toDataURL()\r\n  }\r\n\r\n  static imageBlobToDataUrl(imageBlob: Blob): DataUrl {\r\n    const urlCreator = window.URL || window.webkitURL\r\n    return urlCreator.createObjectURL(imageBlob)\r\n  }\r\n\r\n  static fabricImageFromDataUrl(imageUrl: string): Promise<FabricImage> {\r\n    return new Promise(resolve => fabric.Image.fromURL(imageUrl, resolve))\r\n  }\r\n\r\n  static fold<A, B>(array: B[], init: A, reducer: (init: A, elem: B) => A): A {\r\n    let acc = init\r\n    for (const x of array) acc = reducer(acc, x)\r\n    return acc\r\n  }\r\n\r\n  static async asyncFold<A, B>(array: B[], init: A, reducer: (init: A, elem: B) => Promise<A>): Promise<A> {\r\n    let acc = init\r\n    for (const x of array) acc = await reducer(acc, x)\r\n    return acc\r\n  }\r\n\r\n}\r\n"]}